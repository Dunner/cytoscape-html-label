!function(){"use strict";var s=function(t,e){if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n,o=t.length>>>0,i=e,a=0;a<o;a++)if(n=t[a],e.call(i,n,a,t))return n},a=function(){function t(t,e){var n=t.node,o=t.position,i=void 0===o?null:o,a=t.data,r=void 0===a?null:a;this.updateParams(e),this._node=n,this.initStyles(e.cssClass),r&&this.updateData(r),i&&this.updatePosition(i)}return t.prototype.updateParams=function(t){var e=t.tpl,n=void 0===e?function(){return""}:e,o=(t.cssClass,t.halign),i=void 0===o?"center":o,a=t.valign,r=void 0===a?"center":a,s=(t.ealign,t.halignBox),d=void 0===s?"center":s,u=t.valignBox,p=void 0===u?"center":u,c={top:-.5,left:-.5,center:0,right:.5,bottom:.5};this._align=[c[i],c[r],100*(c[d]-.5),100*(c[p]-.5)],this.tpl=n},t.prototype.updateData=function(t){try{this._node.innerHTML=this.tpl(t)}catch(t){console.error(t)}},t.prototype.getNode=function(){return this._node},t.prototype.updatePosition=function(t){this._renderPosition(t)},t.prototype.initStyles=function(t){this._node.style.position="absolute",t&&t.length&&this._node.classList.add(t)},t.prototype._renderPosition=function(t){var e=this._position,n=t.x+this._align[0]*t.w,o=t.y+this._align[1]*t.h,i=t.a;if(!e||e[0]!==n||e[1]!==o){this._position=[n,o];var a="translate("+this._align[2]+"%,"+this._align[3]+"%) "+("translate("+n.toFixed(2)+"px,"+o.toFixed(2)+"px) "),r=this._node.style;if(i){a+="rotate("+i.toFixed(2)+"deg)";var s=Math.abs(this._align[2]),d=Math.abs(this._align[3]);r.transformOrigin=s+"% "+d+"% 0px"}r.webkitTransform=a,r.msTransform=a,r.transform=a}},t}(),d=function(){function t(t){this._node=t,this._elements={}}return t.prototype.addOrUpdateElem=function(t,e,n){void 0===n&&(n={});var o=this._elements[t];if(o)o.updateParams(e),o.updateData(n.data),o.updatePosition(n.position);else{var i=document.createElement("div");this._node.appendChild(i),this._elements[t]=new a({node:i,data:n.data,position:n.position},e)}},t.prototype.removeElemById=function(t){this._elements[t]&&(this._node.removeChild(this._elements[t].getNode()),delete this._elements[t])},t.prototype.updateElemPosition=function(t,e){var n=this._elements[t];n&&n.updatePosition(e)},t.prototype.updatePanZoom=function(t){var e=t.pan,n=t.zoom,o="translate("+e.x+"px,"+e.y+"px) scale("+n+")",i=this._node.style,a="top left";i.webkitTransform=o,i.msTransform=o,i.transform=o,i.webkitTransformOrigin=a,i.msTransformOrigin=a,i.transformOrigin=a},t.prototype.has=function(t){return void 0!==this._elements[t]},t}();function e(r,t){var i=t&&"object"==typeof t?t:[],o=function(){var t=r.container(),e=document.createElement("div"),n=document.querySelectorAll("cavas"),o=n[n.length-1],i=t.querySelector("[class^='cy-html']");i&&o.parentNode.removeChild(i);var a=e.style;return a.position="absolute",a["z-index"]=10,a.width="500px",a["pointer-events"]="none",a.margin="0px",a.padding="0px",a.border="0px",a.outline="0px",a.outline="0px",o.parentNode.appendChild(e),new d(e)}();return r.one("render",function(t){!function(t){var n=t.cy;i.forEach(function(e){n.elements(e.query).forEach(function(t){o.addOrUpdateElem(t.id(),e,{position:a(t),data:t.data()})})})}(t),e(t)}),r.on("add",function(t){var e=t.target,n=s(i.slice().reverse(),function(t){return e.is(t.query)});n&&o.addOrUpdateElem(e.id(),n,{position:a(e),data:e.data()})}),r.on("layoutstop",function(t){var e=t.cy;i.forEach(function(t){e.elements(t.query).forEach(function(t){o.updateElemPosition(t.id(),a(t))})})}),r.on("remove",function(t){o.removeElemById(t.target.id())}),r.on("data",function(n){setTimeout(function(){var e=n.target,t=s(i.slice().reverse(),function(t){return e.is(t.query)});t?o.addOrUpdateElem(e.id(),t,{position:a(e),data:e.data()}):o.removeElemById(e.id())},0)}),r.on("pan zoom",e),r.on("position bounds",function(t){(o.has(t.target.id())||t.target.connectedEdges(function(t){return o.has(t.id())}).size())&&(o.updateElemPosition(t.target.id(),a(t.target)),t.target.connectedEdges().forEach(function(t){o.updateElemPosition(t.id(),a(t))}))}),r;function e(t){var e=t.cy;o.updatePanZoom({pan:e.pan(),zoom:e.zoom()})}function a(e){if(e.isNode())return{w:e.width(),h:e.height(),x:e.position("x"),y:e.position("y"),a:0};if(e.isEdge()){var t=s(i.slice().reverse(),function(t){return e.is(t.query)});if(t){var n=void 0,o=0;return n="source"===t.ealign?e.sourceEndpoint():"target"===t.ealign?e.targetEndpoint():e.midpoint(),(t.autorotate||e.data("label_autorotate"))&&(o=function(t,e){var n=e.x-t.x,o=e.y-t.y,i=Math.atan(o/n);return 0==n&&i<0&&(i*=-1),180*i/Math.PI}(e.sourceEndpoint(),e.targetEndpoint())),{w:0,h:0,x:n.x,y:n.y,a:o}}}}}var n=function(t){t&&t("core","htmlLabel",function(t){return e(this,t)})};"undefined"!=typeof module&&module.exports?module.exports=function(t){n(t)}:"undefined"!=typeof define&&define.amd&&define("cytoscape-htmlLabel",function(){return n}),"undefined"!=typeof cytoscape&&n(cytoscape)}();